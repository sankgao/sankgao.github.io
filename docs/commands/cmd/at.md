---
title: at
icon: command
date: 2024-07-23
category: 命令集
tag:
    - CMD
---

## 描述

`at` 用于将命令和程序计划在指定的时间和日期在计算机上运行。仅当计划服务正在运行时，才能使用 `at`。如果使用 `at` 时不带参数，则会列出已计划的命令。若要运行此命令，您必须是本地 `Administrators` 组的成员。

::: tip
AT 命令已弃用。请改用 [schtasks](./schtasks.md)。
:::

- 在运行命令之前，此命令不会自动加载 `cmd.exe`。如果运行的不是可执行（`.exe`）文件，则必须在命令的开头显式加载 `cmd.exe`，如下所示：

    ```cmd
    cmd /c dir > c:\test.out
    ```

- 使用 `at` 计划的命令将作为后台进程运行。输出不会显示在计算机屏幕上，要将输出重定向到文件，请使用重定向符号 `>`。如果将输出重定向到文件，则无论在命令行还是在批处理文件中使用 `at`，都需要在重定向符号之前使用转义符号 `^`。例如：要将输出重定向到 `output.txt`，请键入：

    ```cmd
    at 14:45 c:\test.bat ^>c:\output.txt
    ```

## 语法

```cmd
at [\computername] [[id] [/delete] | /delete [/yes]]
at [\computername] <time> [/interactive] [/every:date[,...] | /next:date[,...]] <command>
```

## 选项

|  选项  |  描述  |
|  :----:  |  :----  |
|  `\<computername\>`  |  指定远程计算机。如果省略此参数，则 `at` 将计划本地计算机上的命令和程序  |
|  `<id>`  |  指定分配给已计划命令的标识号  |
|  `/delete`  |  取消已计划的命令。如果省略 ID，将取消计算机上的所有已计划的命令  |
|  `/yes`  |  删除计划事件时，对来自系统的所有查询回答 “是”  |
|  `<time>`  |  指定要运行命令的时间。时间 24 小时表示法表示（即从 00：00（午夜）到 23：59），格式为 “小时:分钟”  |
|  `/interactive`  |  允许命令与在命令运行时登录的用户的桌面进行交互  |
|  `/every:date[,...]`  |  在每周或每月的每个指定日（例如：每个星期四或每月的第三天）运行命令  |
|  `/next:date[,...]`  |  在下一个当天日期（例如：下个星期四）运行命令  |
|  `date`  |  指定要运行命令的日期。您可以指定一周中的一天或多天（即，键入 M、T、W、Th、F、S、Su），也可以指定一个月中的一天或多天（即，键入 1 到 31）。用逗号分隔多个日期条目。如果省略 `date`，则 `at` 使用该月的当前日期  |
|  `<command>`  |  指定要运行的 Windows 命令、程序（即 `.exe` 或 `.com` 文件）或批处理程序（即 `.bat` 或 `.cmd` 文件）。当命令需要路径作为参数时，请使用绝对路径（即以驱动器号开头的整个路径）。如果该命令位于远程计算机上，请为服务器和共享名称指定通用命名约定（UNC）表示法，而不是远程驱动器号  |
|  `/?`  |  在命令提示符下显示帮助  |

## 示例

### 显示计划信息

例如：显示在 Marketing 服务器上计划的命令列表。

```cmd
at \\marketing
```

例如：要了解 Corp 服务器上标识号为 3 的命令的详细信息。

```cmd
at \\corp 3
```

### 添加计划任务

例如：要在每五天的午夜将营销服务器的硬盘驱动器备份到磁带驱动器，请创建名为 `archive.cmd` 的批处理程序（其中包含备份命令），然后计划运行该批处理程序。

```cmd
at \\marketing 00:00 /every:5,10,15,20,25,30 archive
```

### 取消计划任务

例如：要取消当前服务器上计划的所有命令。

```cmd
at /delete
```

### 运行不是可执行的命令

要运行不是可执行（`.exe`）的命令，请在命令前加上 `cmd /c` 以加载 `cmd.exe`。

```cmd
cmd /c dir > c:\test.out
```
