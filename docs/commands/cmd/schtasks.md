---
title: schtasks
icon: command
date: 2024-07-23
category: 命令集
tag:
    - CMD
---

## 描述

`schtasks` 用于将命令和程序计划为定期运行或在特定时间运行、在计划中添加和删除任务、按需启动和停止任务，以及显示和更改计划任务。

## 选项

|  选项  |  描述  |
|  :----:  |  :----  |
|  `schtasks /change`  |  更改任务的以下一个或多个属性  |
|  `schtasks /create`  |  计划新任务  |
|  `schtasks /delete`  |  删除计划任务  |
|  `schtasks /end`  |  停止任务启动的程序  |
|  `schtasks /query`  |  显示计划在计算机上运行的任务  |
|  `schtasks /run`  |  立即启动计划的任务。运行操作会忽略计划，而是使用任务中保存的程序文件位置、用户帐户和密码立即运行任务  |
|  `/?`  |  在命令提示符下显示帮助  |

## 示例

### 计划指定分钟运行一次任务

在分钟计划中，需要用到 `/sc minute` 参数。`/mo`（修饰符）参数为可选参数，用于指定每次运行任务之间的分钟数。`/mo` 的默认值为 1（每分钟）。`/et`（结束时间）和 `/du`（持续时间）参数是可选参数，可以与 `/k`（结束任务）参数一起使用，也可以单独使用。

例如：计划安全脚本 `Sec.vbs` 每 20 分钟运行一次。

```cmd
C:\Users\user>schtasks /create /sc minute /mo 20 /tn "Security Script" /tr \\central\data\scripts\sec.vbs
```

由于此示例不包括开始日期或时间，因此任务在命令完成后 20 分钟启动，并在系统运行时每 20 分钟运行一次。请注意，安全脚本源文件位于远程计算机上，但任务是在本地计算机上计划和执行的。
