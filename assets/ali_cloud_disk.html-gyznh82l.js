import{_ as o}from"./plugin-vue_export-helper-x3n3nnut.js";import{r as e,o as c,c as l,b as n,e as s,d as t,f as p}from"./app-EqfqKacB.js";const i={},u=p('<div class="hint-container warning"><p class="hint-container-title">注意</p><p>无需部署，无需服务器，每个月更新一次 token</p><p>使用金山文档的每日定时任务，执行阿里云盘签到接口</p></div><h2 id="阿里云盘自动签到-v1-0" tabindex="-1"><a class="header-anchor" href="#阿里云盘自动签到-v1-0" aria-hidden="true">#</a> 阿里云盘自动签到-v1.0</h2><h3 id="新建表格" tabindex="-1"><a class="header-anchor" href="#新建表格" aria-hidden="true">#</a> 新建表格</h3>',3),r={class:"hint-container tip"},k=n("p",{class:"hint-container-title"},"提示",-1),d=n("p",null,[s("填写表格时需要注意的地方："),n("strong",null,"是否领取奖励"),s(" 和 "),n("strong",null,"邮箱"),s(" 中间有一列空列，"),n("strong",null,"是否发送邮箱签到提醒"),s(" 和 "),n("strong",null,"是否自定义发送邮箱"),s(" 中间有一列空列。（可以直接复制下面的表格，然后进行修改）")],-1),v=n("strong",null,"refresh_token",-1),m={href:"https://www.aliyundrive.com/sign/in",target:"_blank",rel:"noopener noreferrer"},g=p("<p><strong>邮箱 SMPT 密码</strong> 获取的方法：</p><ul><li>在邮箱中打开设置</li><li>找到 <strong>POP3/SMTP/IMAP</strong> 并开启服务</li><li>找到 <strong>授权密码管理</strong> 点击 <strong>新增授权密码</strong>，然后根据提示操作。<strong>注意</strong> 授权密码只显示一次，需要提前复制保存到其它地方，以防忘记</li></ul>",2),y={href:"https://www.kdocs.cn/latest?from=docs",target:"_blank",rel:"noopener noreferrer"},b=n("strong",null,"Office文档",-1),q=p(`<p>在表格中写入以下内容并保存：</p><table><thead><tr><th style="text-align:center;">refresh_token</th><th style="text-align:center;">是否签到</th><th style="text-align:center;">是否领取奖励</th><th style="text-align:center;"></th><th style="text-align:center;">邮箱</th><th style="text-align:center;">邮箱地址</th><th style="text-align:center;">是否发送邮箱签到提醒</th><th style="text-align:center;"></th><th style="text-align:center;">是否自定义发送邮箱</th><th style="text-align:center;">是</th></tr></thead><tbody><tr><td style="text-align:center;">23c63ea0cc43baf970525aad5</td><td style="text-align:center;">是</td><td style="text-align:center;">是</td><td style="text-align:center;"></td><td style="text-align:center;">接收邮箱地址</td><td style="text-align:center;">sankgao@163.com</td><td style="text-align:center;">是</td><td style="text-align:center;"></td><td style="text-align:center;">SMTP 服务器域名</td><td style="text-align:center;">smtp.163.com</td></tr><tr><td style="text-align:center;"></td><td style="text-align:center;"></td><td style="text-align:center;"></td><td style="text-align:center;"></td><td style="text-align:center;">接收邮箱地址</td><td style="text-align:center;"></td><td style="text-align:center;"></td><td style="text-align:center;"></td><td style="text-align:center;">port</td><td style="text-align:center;">465</td></tr><tr><td style="text-align:center;"></td><td style="text-align:center;"></td><td style="text-align:center;"></td><td style="text-align:center;"></td><td style="text-align:center;">接收邮箱地址</td><td style="text-align:center;"></td><td style="text-align:center;"></td><td style="text-align:center;"></td><td style="text-align:center;">发送邮箱地址</td><td style="text-align:center;">sankgao@163.com</td></tr><tr><td style="text-align:center;"></td><td style="text-align:center;"></td><td style="text-align:center;"></td><td style="text-align:center;"></td><td style="text-align:center;">接收邮箱地址</td><td style="text-align:center;"></td><td style="text-align:center;"></td><td style="text-align:center;"></td><td style="text-align:center;">邮箱 SMTP 密码</td><td style="text-align:center;">MRILGSPEYBQ</td></tr></tbody></table><ul><li><p><strong>refresh_token</strong>：从浏览器中获取 <code>refresh_token</code> 值，可以写入多个账户的 <code>refresh_token</code>。获取 <code>refresh_token</code> 值步骤如下：</p><ul><li><strong>浏览器登陆阿里云盘</strong></li><li>点击 <strong>F12</strong></li><li>点击 <strong>应用（应用程序）</strong></li><li>点击 <strong>本地存储空间 -&gt; https://www.aliyundrive.com</strong></li><li>点击 <strong>token</strong></li><li>复制 <strong>refresh_token 对应的值</strong></li></ul></li><li><p><strong>是否领取奖励</strong>：</p><ul><li><strong>是</strong>：自动领取签到奖励</li><li><strong>否</strong>：只签到，需要自己手动领取签到奖励</li></ul></li><li><p><strong>是否发送邮箱签到提醒</strong>：如果需要发送邮箱通知，要写入对应的 <strong>接收邮箱地址</strong>，不发送就不用写（或者选择否）。支持发送到多个邮箱地址</p></li><li><p><strong>是否自定义发送邮箱</strong>：如果需要写入以下 <strong>配置</strong>，不需要自定义就不用写（或者选择否）</p><ul><li><p><strong>SMTP 服务器域名</strong>：根据自己的邮箱选择写入 SMTP 服务器域名</p><ul><li><strong>163.com</strong>：<code>smtp.163.com</code></li><li><strong>QQ 邮箱</strong>：<code>smtp.qq.com</code></li></ul></li><li><p><strong>port</strong>：发送端口</p></li><li><p><strong>发送邮箱地址</strong></p></li><li><p><strong>邮箱 SMPT 密码</strong>：SMPT 服务授权密码。并非邮箱账户登陆密码</p></li></ul></li></ul><h3 id="创建-airscript-脚本" tabindex="-1"><a class="header-anchor" href="#创建-airscript-脚本" aria-hidden="true">#</a> 创建 AirScript 脚本</h3><p>在表格页面上方，依次点击 <em>效率 -&gt; 高级开发 -&gt; AirScript脚本编辑器。</em></p><p>在 <strong>AirScript脚本编辑器</strong> 中，依次点击 <em>创建脚本 -&gt; 文档共享脚本。</em></p><details class="hint-container details"><summary>脚本中写入以下代码并保存</summary><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">var</span> myDate <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 创建一个表示当前时间的 Date 对象</span>
<span class="token keyword">var</span> year <span class="token operator">=</span> myDate<span class="token punctuation">.</span><span class="token function">getFullYear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 获取年份</span>
<span class="token keyword">var</span> month <span class="token operator">=</span> myDate<span class="token punctuation">.</span><span class="token function">getMonth</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>  <span class="token comment">// 获取月份（注意加 1，因为月份从 0 开始）</span>
<span class="token keyword">var</span> day <span class="token operator">=</span> myDate<span class="token punctuation">.</span><span class="token function">getDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 获取日期</span>

<span class="token comment">// 格式化成 &quot;YYYY/MM/DD&quot; 格式</span>
<span class="token keyword">var</span> data_time <span class="token operator">=</span> year <span class="token operator">+</span> <span class="token string">&#39;/&#39;</span> <span class="token operator">+</span> <span class="token punctuation">(</span>month <span class="token operator">&lt;</span> <span class="token number">10</span> <span class="token operator">?</span> <span class="token string">&#39;0&#39;</span> <span class="token operator">:</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">)</span> <span class="token operator">+</span> month <span class="token operator">+</span> <span class="token string">&#39;/&#39;</span> <span class="token operator">+</span> <span class="token punctuation">(</span>day <span class="token operator">&lt;</span> <span class="token number">10</span> <span class="token operator">?</span> <span class="token string">&#39;0&#39;</span> <span class="token operator">:</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">)</span> <span class="token operator">+</span> day<span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">sleep</span><span class="token punctuation">(</span><span class="token parameter">d</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> t <span class="token operator">=</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> t <span class="token operator">&lt;=</span> d<span class="token punctuation">;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 使程序暂停执行一段时间</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">log</span><span class="token punctuation">(</span><span class="token parameter">message</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 打印消息到控制台</span>
  <span class="token comment">// TODO: 将日志写入文件</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> tokenColumn <span class="token operator">=</span> <span class="token string">&quot;A&quot;</span><span class="token punctuation">;</span>  <span class="token comment">// 设置列号变量为 &quot;A&quot;</span>
<span class="token keyword">var</span> signInColumn <span class="token operator">=</span> <span class="token string">&quot;B&quot;</span><span class="token punctuation">;</span>  <span class="token comment">// 设置列号变量为 &quot;B&quot;</span>
<span class="token keyword">var</span> rewardColumn <span class="token operator">=</span> <span class="token string">&quot;C&quot;</span><span class="token punctuation">;</span>  <span class="token comment">// 设置列号变量为 &quot;C&quot;</span>
<span class="token keyword">var</span> emailColumn <span class="token operator">=</span> <span class="token string">&quot;F&quot;</span><span class="token punctuation">;</span>  <span class="token comment">// 设置列号变量为 &quot;F&quot;</span>
<span class="token keyword">var</span> sendEmailColumn <span class="token operator">=</span> <span class="token string">&quot;G&quot;</span><span class="token punctuation">;</span>  <span class="token comment">// 设置列号变量为 &quot;G&quot;</span>
<span class="token keyword">var</span> resultColumn <span class="token operator">=</span> <span class="token string">&quot;J&quot;</span><span class="token punctuation">;</span>  <span class="token comment">// 设置列号变量为 &quot;J&quot;</span>

<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> row <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span> row <span class="token operator">&lt;=</span> <span class="token number">20</span><span class="token punctuation">;</span> row<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token comment">// 循环遍历从第 2 行到第 20 行的数据</span>
  <span class="token keyword">var</span> refresh_token <span class="token operator">=</span> Application<span class="token punctuation">.</span><span class="token function">Range</span><span class="token punctuation">(</span>tokenColumn <span class="token operator">+</span> row<span class="token punctuation">)</span><span class="token punctuation">.</span>Text<span class="token punctuation">;</span>  <span class="token comment">// 获取指定单元格的值</span>
  <span class="token keyword">var</span> sflq <span class="token operator">=</span> Application<span class="token punctuation">.</span><span class="token function">Range</span><span class="token punctuation">(</span>signInColumn <span class="token operator">+</span> row<span class="token punctuation">)</span><span class="token punctuation">.</span>Text<span class="token punctuation">;</span>  <span class="token comment">// 获取指定单元格的值</span>
  <span class="token keyword">var</span> sflqReward <span class="token operator">=</span> Application<span class="token punctuation">.</span><span class="token function">Range</span><span class="token punctuation">(</span>rewardColumn <span class="token operator">+</span> row<span class="token punctuation">)</span><span class="token punctuation">.</span>Text<span class="token punctuation">;</span>  <span class="token comment">// 获取指定单元格的值</span>
  <span class="token keyword">var</span> jsyx <span class="token operator">=</span> Application<span class="token punctuation">.</span><span class="token function">Range</span><span class="token punctuation">(</span>emailColumn <span class="token operator">+</span> row<span class="token punctuation">)</span><span class="token punctuation">.</span>Text<span class="token punctuation">;</span>  <span class="token comment">// 获取指定单元格的值</span>
  <span class="token keyword">var</span> sendEmail <span class="token operator">=</span> Application<span class="token punctuation">.</span><span class="token function">Range</span><span class="token punctuation">(</span>sendEmailColumn <span class="token operator">+</span> row<span class="token punctuation">)</span><span class="token punctuation">.</span>Text<span class="token punctuation">;</span>  <span class="token comment">// 获取指定单元格的值</span>
  <span class="token keyword">var</span> customEmailResult <span class="token operator">=</span> Application<span class="token punctuation">.</span><span class="token function">Range</span><span class="token punctuation">(</span>resultColumn <span class="token operator">+</span> row<span class="token punctuation">)</span><span class="token punctuation">.</span>Text<span class="token punctuation">;</span>  <span class="token comment">// 获取指定单元格的值</span>

  <span class="token keyword">var</span> emailConfigured <span class="token operator">=</span> Application<span class="token punctuation">.</span><span class="token function">Range</span><span class="token punctuation">(</span><span class="token string">&quot;J1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Text<span class="token punctuation">;</span>  <span class="token comment">// 获取指定单元格的值</span>
  <span class="token keyword">var</span> zdy_host <span class="token operator">=</span> Application<span class="token punctuation">.</span><span class="token function">Range</span><span class="token punctuation">(</span><span class="token string">&quot;J2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Text<span class="token punctuation">;</span>  <span class="token comment">// 获取指定单元格的值</span>
  <span class="token keyword">var</span> zdy_post <span class="token operator">=</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>Application<span class="token punctuation">.</span><span class="token function">Range</span><span class="token punctuation">(</span><span class="token string">&quot;J3&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Text<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 获取指定单元格的值并转换为整数</span>
  <span class="token keyword">var</span> zdy_username <span class="token operator">=</span> Application<span class="token punctuation">.</span><span class="token function">Range</span><span class="token punctuation">(</span><span class="token string">&quot;J4&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Text<span class="token punctuation">;</span>  <span class="token comment">// 获取指定单元格的值</span>
  <span class="token keyword">var</span> zdy_pasd <span class="token operator">=</span> Application<span class="token punctuation">.</span><span class="token function">Range</span><span class="token punctuation">(</span><span class="token string">&quot;J5&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Text<span class="token punctuation">;</span>  <span class="token comment">// 获取指定单元格的值</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span>sflq <span class="token operator">==</span> <span class="token string">&quot;是&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token comment">// 如果 “是否签到” 为 “是”</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>refresh_token <span class="token operator">!=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token comment">// 如果刷新令牌不为空</span>
      <span class="token comment">// 发起网络请求-获取 token</span>
      <span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token constant">HTTP</span><span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">&quot;https://auth.aliyundrive.com/v2/account/token&quot;</span><span class="token punctuation">,</span>
        <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          <span class="token string-property property">&quot;grant_type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;refresh_token&quot;</span><span class="token punctuation">,</span>
          <span class="token string-property property">&quot;refresh_token&quot;</span><span class="token operator">:</span> refresh_token
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">)</span><span class="token punctuation">;</span>
      data <span class="token operator">=</span> data<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 将响应数据解析为 JSON 格式</span>
      <span class="token keyword">var</span> access_token <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token string">&#39;access_token&#39;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>  <span class="token comment">// 获取访问令牌</span>
      <span class="token keyword">var</span> phone <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token string">&quot;user_name&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>  <span class="token comment">// 获取用户名</span>

      <span class="token keyword">if</span> <span class="token punctuation">(</span>access_token <span class="token operator">==</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token comment">// 如果访问令牌未定义</span>
        <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;单元格【&quot;</span> <span class="token operator">+</span> tokenColumn <span class="token operator">+</span> row <span class="token operator">+</span> <span class="token string">&quot;】内的 token 值错误，程序执行失败，请重新复制正确的 token 值&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">continue</span><span class="token punctuation">;</span>  <span class="token comment">// 跳过当前行的后续操作</span>
      <span class="token punctuation">}</span>

      <span class="token keyword">try</span> <span class="token punctuation">{</span>
        <span class="token keyword">var</span> access_token2 <span class="token operator">=</span> <span class="token string">&#39;Bearer &#39;</span> <span class="token operator">+</span> access_token<span class="token punctuation">;</span>  <span class="token comment">// 构建包含访问令牌的请求头</span>
        <span class="token comment">// 签到</span>
        <span class="token keyword">let</span> data2 <span class="token operator">=</span> <span class="token constant">HTTP</span><span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">&quot;https://member.aliyundrive.com/v1/activity/sign_in_list&quot;</span><span class="token punctuation">,</span>
          <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token string-property property">&quot;_rx-s&quot;</span><span class="token operator">:</span> <span class="token string">&quot;mobile&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          <span class="token punctuation">{</span> <span class="token literal-property property">headers</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token string-property property">&quot;Authorization&quot;</span><span class="token operator">:</span> access_token2 <span class="token punctuation">}</span> <span class="token punctuation">}</span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
        data2 <span class="token operator">=</span> data2<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 将响应数据解析为 JSON 格式</span>
        <span class="token keyword">var</span> signin_count <span class="token operator">=</span> data2<span class="token punctuation">[</span><span class="token string">&#39;result&#39;</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">&#39;signInCount&#39;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>  <span class="token comment">// 获取签到次数</span>

        <span class="token keyword">var</span> logMessage <span class="token operator">=</span> <span class="token string">&quot;账号：&quot;</span> <span class="token operator">+</span> phone <span class="token operator">+</span> <span class="token string">&quot; - 签到成功，本月累计签到 &quot;</span> <span class="token operator">+</span> signin_count <span class="token operator">+</span> <span class="token string">&quot; 天&quot;</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> rewardMessage <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>sflqReward <span class="token operator">==</span> <span class="token string">&quot;是&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token comment">// 如果 “是否领取奖励” 为 “是”</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span>sflq <span class="token operator">==</span> <span class="token string">&quot;是&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token comment">// 如果 “是否签到” 为 “是”</span>
            <span class="token keyword">try</span> <span class="token punctuation">{</span>
              <span class="token comment">// 领取奖励</span>
              <span class="token keyword">let</span> data3 <span class="token operator">=</span> <span class="token constant">HTTP</span><span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span>
                <span class="token string">&quot;https://member.aliyundrive.com/v1/activity/sign_in_reward?_rx-s=mobile&quot;</span><span class="token punctuation">,</span>
                <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token string-property property">&quot;signInDay&quot;</span><span class="token operator">:</span> signin_count <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token punctuation">{</span> <span class="token literal-property property">headers</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token string-property property">&quot;Authorization&quot;</span><span class="token operator">:</span> access_token2 <span class="token punctuation">}</span> <span class="token punctuation">}</span>
              <span class="token punctuation">)</span><span class="token punctuation">;</span>
              data3 <span class="token operator">=</span> data3<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 将响应数据解析为 JSON 格式</span>
              <span class="token keyword">var</span> rewardName <span class="token operator">=</span> data3<span class="token punctuation">[</span><span class="token string">&quot;result&quot;</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>  <span class="token comment">// 获取奖励名称</span>
              <span class="token keyword">var</span> rewardDescription <span class="token operator">=</span> data3<span class="token punctuation">[</span><span class="token string">&quot;result&quot;</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">&quot;description&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>  <span class="token comment">// 获取奖励描述</span>
              rewardMessage <span class="token operator">=</span> <span class="token string">&quot; &quot;</span> <span class="token operator">+</span> rewardName <span class="token operator">+</span> <span class="token string">&quot; - &quot;</span> <span class="token operator">+</span> rewardDescription<span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
              <span class="token keyword">if</span> <span class="token punctuation">(</span>error<span class="token punctuation">.</span>response <span class="token operator">&amp;&amp;</span> error<span class="token punctuation">.</span>response<span class="token punctuation">.</span>data <span class="token operator">&amp;&amp;</span> error<span class="token punctuation">.</span>response<span class="token punctuation">.</span>data<span class="token punctuation">.</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">var</span> errorMessage <span class="token operator">=</span> error<span class="token punctuation">.</span>response<span class="token punctuation">.</span>data<span class="token punctuation">.</span>error<span class="token punctuation">;</span>  <span class="token comment">// 获取错误信息</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>errorMessage<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span><span class="token string">&quot; - 今天奖励已领取&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                  rewardMessage <span class="token operator">=</span> <span class="token string">&quot; - 今天奖励已领取&quot;</span><span class="token punctuation">;</span>
                  <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;账号：&quot;</span> <span class="token operator">+</span> phone <span class="token operator">+</span> <span class="token string">&quot; - &quot;</span> <span class="token operator">+</span> rewardMessage<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                  <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;账号：&quot;</span> <span class="token operator">+</span> phone <span class="token operator">+</span> <span class="token string">&quot; - 奖励领取失败：&quot;</span> <span class="token operator">+</span> errorMessage<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
              <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;账号：&quot;</span> <span class="token operator">+</span> phone <span class="token operator">+</span> <span class="token string">&quot; - 奖励领取失败&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
              <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
          <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            rewardMessage <span class="token operator">=</span> <span class="token string">&quot; - 奖励待领取&quot;</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
          rewardMessage <span class="token operator">=</span> <span class="token string">&quot; - 奖励待领取&quot;</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token function">log</span><span class="token punctuation">(</span>logMessage <span class="token operator">+</span> rewardMessage<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>sendEmail <span class="token operator">==</span> <span class="token string">&quot;是&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token comment">// 如果 “是否发送邮件” 为 “是”</span>
          <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token keyword">let</span> mailer<span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>customEmailResult <span class="token operator">==</span> <span class="token string">&quot;是&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token comment">// 如果 “是否自定义邮箱” 为 “是”</span>
              <span class="token keyword">var</span> customEmail <span class="token operator">=</span> Application<span class="token punctuation">.</span><span class="token function">Range</span><span class="token punctuation">(</span>resultColumn <span class="token operator">+</span> row<span class="token punctuation">)</span><span class="token punctuation">.</span>Text<span class="token punctuation">;</span>  <span class="token comment">// 获取指定单元格的值</span>
              <span class="token keyword">if</span> <span class="token punctuation">(</span>emailConfigured <span class="token operator">===</span> <span class="token string">&quot;是&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token comment">// 如果配置了自定义邮箱</span>
                mailer <span class="token operator">=</span> <span class="token constant">SMTP</span><span class="token punctuation">.</span><span class="token function">login</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                  <span class="token literal-property property">host</span><span class="token operator">:</span> zdy_host<span class="token punctuation">,</span>
                  <span class="token literal-property property">port</span><span class="token operator">:</span> zdy_post<span class="token punctuation">,</span>
                  <span class="token literal-property property">username</span><span class="token operator">:</span> zdy_username<span class="token punctuation">,</span>
                  <span class="token literal-property property">password</span><span class="token operator">:</span> zdy_pasd<span class="token punctuation">,</span>
                  <span class="token literal-property property">secure</span><span class="token operator">:</span> <span class="token boolean">true</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                mailer<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                  <span class="token literal-property property">from</span><span class="token operator">:</span> <span class="token string">&quot;阿里云盘签到&lt;&quot;</span> <span class="token operator">+</span> zdy_username <span class="token operator">+</span> <span class="token string">&quot;&gt;&quot;</span><span class="token punctuation">,</span>
                  <span class="token literal-property property">to</span><span class="token operator">:</span> customEmail<span class="token punctuation">,</span>
                  <span class="token literal-property property">subject</span><span class="token operator">:</span> <span class="token string">&quot;阿里云盘签到通知 - &quot;</span> <span class="token operator">+</span> data_time<span class="token punctuation">,</span>
                  <span class="token literal-property property">text</span><span class="token operator">:</span> logMessage <span class="token operator">+</span> rewardMessage
                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
              <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>  <span class="token comment">// 如果未配置自定义邮箱，默认使用示例邮箱</span>
                mailer <span class="token operator">=</span> <span class="token constant">SMTP</span><span class="token punctuation">.</span><span class="token function">login</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                  <span class="token literal-property property">host</span><span class="token operator">:</span> <span class="token string">&quot;smtp.163.com&quot;</span><span class="token punctuation">,</span>
                  <span class="token literal-property property">port</span><span class="token operator">:</span> <span class="token number">465</span><span class="token punctuation">,</span>
                  <span class="token literal-property property">username</span><span class="token operator">:</span> <span class="token string">&quot;sankgao@163.com&quot;</span><span class="token punctuation">,</span>
                  <span class="token literal-property property">password</span><span class="token operator">:</span> <span class="token string">&quot;MRDIJBLGSPFOEYBQ&quot;</span><span class="token punctuation">,</span>
                  <span class="token literal-property property">secure</span><span class="token operator">:</span> <span class="token boolean">true</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                mailer<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                  <span class="token literal-property property">from</span><span class="token operator">:</span> <span class="token string">&quot;阿里云盘签到&lt;sankgao@163.com&gt;&quot;</span><span class="token punctuation">,</span>
                  <span class="token literal-property property">to</span><span class="token operator">:</span> customEmail<span class="token punctuation">,</span>
                  <span class="token literal-property property">subject</span><span class="token operator">:</span> <span class="token string">&quot;阿里云盘签到通知 - &quot;</span> <span class="token operator">+</span> data_time<span class="token punctuation">,</span>
                  <span class="token literal-property property">text</span><span class="token operator">:</span> logMessage <span class="token operator">+</span> rewardMessage
                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
              <span class="token punctuation">}</span>
              <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;账号：&quot;</span> <span class="token operator">+</span> phone <span class="token operator">+</span> <span class="token string">&quot; - 已发送邮件至：&quot;</span> <span class="token operator">+</span> customEmail<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>  <span class="token comment">// 如果 “是否自定义邮箱” 为 “否”</span>
              <span class="token keyword">if</span> <span class="token punctuation">(</span>emailConfigured <span class="token operator">===</span> <span class="token string">&quot;是&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token comment">// 如果配置了自定义邮箱</span>
                mailer <span class="token operator">=</span> <span class="token constant">SMTP</span><span class="token punctuation">.</span><span class="token function">login</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                  <span class="token literal-property property">host</span><span class="token operator">:</span> zdy_host<span class="token punctuation">,</span>
                  <span class="token literal-property property">port</span><span class="token operator">:</span> zdy_post<span class="token punctuation">,</span>
                  <span class="token literal-property property">username</span><span class="token operator">:</span> zdy_username<span class="token punctuation">,</span>
                  <span class="token literal-property property">password</span><span class="token operator">:</span> zdy_pasd<span class="token punctuation">,</span>
                  <span class="token literal-property property">secure</span><span class="token operator">:</span> <span class="token boolean">true</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                mailer<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                  <span class="token literal-property property">from</span><span class="token operator">:</span> <span class="token string">&quot;阿里云盘签到&lt;&quot;</span> <span class="token operator">+</span> zdy_username <span class="token operator">+</span> <span class="token string">&quot;&gt;&quot;</span><span class="token punctuation">,</span>
                  <span class="token literal-property property">to</span><span class="token operator">:</span> jsyx<span class="token punctuation">,</span>
                  <span class="token literal-property property">subject</span><span class="token operator">:</span> <span class="token string">&quot;阿里云盘签到通知 - &quot;</span> <span class="token operator">+</span> data_time<span class="token punctuation">,</span>
                  <span class="token literal-property property">text</span><span class="token operator">:</span> logMessage <span class="token operator">+</span> rewardMessage
                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
              <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>  <span class="token comment">// 如果未配置自定义邮箱，默认使用示例邮箱</span>
                mailer <span class="token operator">=</span> <span class="token constant">SMTP</span><span class="token punctuation">.</span><span class="token function">login</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                  <span class="token literal-property property">host</span><span class="token operator">:</span> <span class="token string">&quot;smtp.163.com&quot;</span><span class="token punctuation">,</span>
                  <span class="token literal-property property">port</span><span class="token operator">:</span> <span class="token number">465</span><span class="token punctuation">,</span>
                  <span class="token literal-property property">username</span><span class="token operator">:</span> <span class="token string">&quot;sankgao@163.com&quot;</span><span class="token punctuation">,</span>
                  <span class="token literal-property property">password</span><span class="token operator">:</span> <span class="token string">&quot;MRDIJBLGSPFOEYBQ&quot;</span><span class="token punctuation">,</span>
                  <span class="token literal-property property">secure</span><span class="token operator">:</span> <span class="token boolean">true</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                mailer<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                  <span class="token literal-property property">from</span><span class="token operator">:</span> <span class="token string">&quot;阿里云盘签到&lt;sankgao@163.com&gt;&quot;</span><span class="token punctuation">,</span>
                  <span class="token literal-property property">to</span><span class="token operator">:</span> jsyx<span class="token punctuation">,</span>
                  <span class="token literal-property property">subject</span><span class="token operator">:</span> <span class="token string">&quot;阿里云盘签到通知 - &quot;</span> <span class="token operator">+</span> data_time<span class="token punctuation">,</span>
                  <span class="token literal-property property">text</span><span class="token operator">:</span> logMessage <span class="token operator">+</span> rewardMessage
                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
              <span class="token punctuation">}</span>
              <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;账号：&quot;</span> <span class="token operator">+</span> phone <span class="token operator">+</span> <span class="token string">&quot; - 已发送邮件至：&quot;</span> <span class="token operator">+</span> jsyx<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
          <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;账号：&quot;</span> <span class="token operator">+</span> phone <span class="token operator">+</span> <span class="token string">&quot; - 发送邮件失败：&quot;</span> <span class="token operator">+</span> error<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">{</span>
        <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;单元格【&quot;</span> <span class="token operator">+</span> tokenColumn <span class="token operator">+</span> row <span class="token operator">+</span> <span class="token string">&quot;】内的 token 签到失败&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">continue</span><span class="token punctuation">;</span>  <span class="token comment">// 跳过当前行的后续操作</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;账号：&quot;</span> <span class="token operator">+</span> phone <span class="token operator">+</span> <span class="token string">&quot; 不签到&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> currentDate <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 创建一个表示当前时间的 Date 对象</span>
<span class="token keyword">var</span> currentDay <span class="token operator">=</span> currentDate<span class="token punctuation">.</span><span class="token function">getDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 获取当前日期的天数</span>
<span class="token keyword">var</span> lastDayOfMonth <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span>currentDate<span class="token punctuation">.</span><span class="token function">getFullYear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> currentDate<span class="token punctuation">.</span><span class="token function">getMonth</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 获取当月的最后一天的日期</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span>currentDay <span class="token operator">===</span> lastDayOfMonth<span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token comment">// 如果当前日期是当月的最后一天</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> row <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span> row <span class="token operator">&lt;=</span> <span class="token number">20</span><span class="token punctuation">;</span> row<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token comment">// 循环遍历从第 2 行到第 20 行的数据</span>
    <span class="token keyword">var</span> sflq <span class="token operator">=</span> Application<span class="token punctuation">.</span><span class="token function">Range</span><span class="token punctuation">(</span>signInColumn <span class="token operator">+</span> row<span class="token punctuation">)</span><span class="token punctuation">.</span>Text<span class="token punctuation">;</span>  <span class="token comment">// 获取指定单元格的值</span>
    <span class="token keyword">var</span> sflqReward <span class="token operator">=</span> Application<span class="token punctuation">.</span><span class="token function">Range</span><span class="token punctuation">(</span>rewardColumn <span class="token operator">+</span> row<span class="token punctuation">)</span><span class="token punctuation">.</span>Text<span class="token punctuation">;</span>  <span class="token comment">// 获取指定单元格的值</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>sflq <span class="token operator">===</span> <span class="token string">&quot;是&quot;</span> <span class="token operator">&amp;&amp;</span> sflqReward <span class="token operator">===</span> <span class="token string">&quot;是&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token comment">// 如果 “是否签到” 和 “是否领取奖励” 均为 “是”</span>
      <span class="token keyword">var</span> refresh_token <span class="token operator">=</span> Application<span class="token punctuation">.</span><span class="token function">Range</span><span class="token punctuation">(</span>tokenColumn <span class="token operator">+</span> row<span class="token punctuation">)</span><span class="token punctuation">.</span>Text<span class="token punctuation">;</span>  <span class="token comment">// 获取指定单元格的值</span>
      <span class="token keyword">var</span> jsyx <span class="token operator">=</span> Application<span class="token punctuation">.</span><span class="token function">Range</span><span class="token punctuation">(</span>emailColumn <span class="token operator">+</span> row<span class="token punctuation">)</span><span class="token punctuation">.</span>Text<span class="token punctuation">;</span>  <span class="token comment">// 获取指定单元格的值</span>
      <span class="token keyword">var</span> phone <span class="token operator">=</span> <span class="token string">&quot;账号：&quot;</span> <span class="token operator">+</span> phone<span class="token punctuation">;</span>  <span class="token comment">// 构建账号信息字符串</span>

      <span class="token keyword">if</span> <span class="token punctuation">(</span>refresh_token <span class="token operator">!==</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token comment">// 如果刷新令牌不为空</span>
        <span class="token comment">// 发起网络请求-获取 token</span>
        <span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token constant">HTTP</span><span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">&quot;https://auth.aliyundrive.com/v2/account/token&quot;</span><span class="token punctuation">,</span>
          <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            <span class="token string-property property">&quot;grant_type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;refresh_token&quot;</span><span class="token punctuation">,</span>
            <span class="token string-property property">&quot;refresh_token&quot;</span><span class="token operator">:</span> refresh_token
          <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
        data <span class="token operator">=</span> data<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 将响应数据解析为 JSON 格式</span>
        <span class="token keyword">var</span> access_token <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token string">&#39;access_token&#39;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>  <span class="token comment">// 获取访问令牌</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>access_token <span class="token operator">===</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token comment">// 如果访问令牌未定义</span>
          <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;单元格【&quot;</span> <span class="token operator">+</span> tokenColumn <span class="token operator">+</span> row <span class="token operator">+</span> <span class="token string">&quot;】内的 token 值错误，程序执行失败，请重新复制正确的 token 值&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token keyword">continue</span><span class="token punctuation">;</span>  <span class="token comment">// 跳过当前行的后续操作</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">try</span> <span class="token punctuation">{</span>
          <span class="token keyword">var</span> access_token2 <span class="token operator">=</span> <span class="token string">&#39;Bearer &#39;</span> <span class="token operator">+</span> access_token<span class="token punctuation">;</span>  <span class="token comment">// 构建包含访问令牌的请求头</span>
          <span class="token comment">// 领取奖励</span>
          <span class="token keyword">let</span> data4 <span class="token operator">=</span> <span class="token constant">HTTP</span><span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span>
            <span class="token string">&quot;https://member.aliyundrive.com/v1/activity/sign_in_reward?_rx-s=mobile&quot;</span><span class="token punctuation">,</span>
            <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token string-property property">&quot;signInDay&quot;</span><span class="token operator">:</span> lastDayOfMonth <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span> <span class="token literal-property property">headers</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token string-property property">&quot;Authorization&quot;</span><span class="token operator">:</span> access_token2 <span class="token punctuation">}</span> <span class="token punctuation">}</span>
          <span class="token punctuation">)</span><span class="token punctuation">;</span>
          data4 <span class="token operator">=</span> data4<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 将响应数据解析为 JSON 格式</span>
          <span class="token keyword">var</span> claimStatus <span class="token operator">=</span> data4<span class="token punctuation">[</span><span class="token string">&quot;result&quot;</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">&quot;status&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>  <span class="token comment">// 获取奖励状态</span>
          <span class="token keyword">var</span> day <span class="token operator">=</span> lastDayOfMonth<span class="token punctuation">;</span>  <span class="token comment">// 获取最后一天的日期</span>

          <span class="token keyword">if</span> <span class="token punctuation">(</span>claimStatus <span class="token operator">===</span> <span class="token string">&quot;CLAIMED&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;账号：&quot;</span> <span class="token operator">+</span> phone <span class="token operator">+</span> <span class="token string">&quot; - 第 &quot;</span> <span class="token operator">+</span> day <span class="token operator">+</span> <span class="token string">&quot; 天奖励领取成功&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;账号：&quot;</span> <span class="token operator">+</span> phone <span class="token operator">+</span> <span class="token string">&quot; - 第 &quot;</span> <span class="token operator">+</span> day <span class="token operator">+</span> <span class="token string">&quot; 天奖励领取失败&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">{</span>
          <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;单元格【&quot;</span> <span class="token operator">+</span> tokenColumn <span class="token operator">+</span> row <span class="token operator">+</span> <span class="token string">&quot;】内的 token 签到失败&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token keyword">continue</span><span class="token punctuation">;</span>  <span class="token comment">// 跳过当前行的后续操作</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;账号：&quot;</span> <span class="token operator">+</span> phone <span class="token operator">+</span> <span class="token string">&quot; 不签到&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;自动领取未领取奖励完成。&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></details><p>脚本中需要修改的地方：</p><ul><li><strong>username: &quot;sankgao@163.com&quot;</strong>：修改为自己的邮箱</li><li><strong>password: &quot;MRILGSPEYBQ&quot;</strong>：修改为自己的 SMPT 服务器授权密码</li><li><strong>from: &quot;阿里云盘签到&lt;sankgao@163.com&gt;&quot;</strong>：修改为自己的邮箱</li></ul><h3 id="添加服务" tabindex="-1"><a class="header-anchor" href="#添加服务" aria-hidden="true">#</a> 添加服务</h3><p>在脚本页面点击 <strong>服务 -&gt; 添加服务</strong>，依次添加 <strong>云文档API</strong>、<strong>邮件API</strong>、<strong>网络API。</strong></p><h3 id="自动运行脚本" tabindex="-1"><a class="header-anchor" href="#自动运行脚本" aria-hidden="true">#</a> 自动运行脚本</h3><p><strong>手动运行</strong></p><p>保存脚本后，手动点击 <strong>运行</strong>，运行消息在下方日志中显示。</p><p><strong>自动运行</strong></p><p>在上方的表格页面中，依次点击 <strong>效率 -&gt; 高级开发 -&gt; 定时任务。</strong></p><p>表格右侧出现 <strong>定时任务</strong> 点击 <strong>创建任务</strong>，设置 <strong>每天触发时间</strong>，选择 <strong>刚刚创建的脚本</strong>，确定。</p><h3 id="快速获取-refresh-token-值" tabindex="-1"><a class="header-anchor" href="#快速获取-refresh-token-值" aria-hidden="true">#</a> 快速获取 refresh_token 值</h3><p>浏览器登陆阿里云盘并点击 <code>F12</code> 后，找到控制台界面，在控制台输入以下内容：</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">var</span> token <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>localStorage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span><span class="token string">&#39;token&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;refresh_token:&#39;</span><span class="token punctuation">,</span> token<span class="token punctuation">.</span>refresh_token<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="阿里云盘自动签到-v2-0" tabindex="-1"><a class="header-anchor" href="#阿里云盘自动签到-v2-0" aria-hidden="true">#</a> 阿里云盘自动签到-v2.0</h2>`,21),h=n("li",null,"取消邮箱通知",-1),f={href:"https://www.pushplus.plus/",target:"_blank",rel:"noopener noreferrer"},w={href:"https://sct.ftqq.com/",target:"_blank",rel:"noopener noreferrer"},_=n("li",null,"新增获取 token 时间大于 25 天提醒更换 token",-1),x={href:"https://zhuanlan.zhihu.com/p/672010242",target:"_blank",rel:"noopener noreferrer"},M={class:"hint-container info"},T=n("p",{class:"hint-container-title"},"相关信息",-1),S={href:"https://zhuanlan.zhihu.com/p/629476969",target:"_blank",rel:"noopener noreferrer"},D={href:"https://zhuanlan.zhihu.com/p/643179804",target:"_blank",rel:"noopener noreferrer"};function P(A,C){const a=e("ExternalLinkIcon");return c(),l("div",null,[u,n("div",r,[k,d,n("p",null,[v,s(" 填写自己账号在登陆后的 "),n("a",m,[s("阿里云盘网页"),t(a)]),s(" 中获取到的值")]),g]),n("p",null,[s("打开 "),n("a",y,[s("金山文档（网页版也可以）"),t(a)]),s("，新建一个 "),b,s(" 空表格。")]),q,n("ul",null,[h,n("li",null,[s("使用 "),n("a",f,[s("PushPlus"),t(a)]),s(" 或 "),n("a",w,[s("Serverchan"),t(a)]),s(" 通知")]),_]),n("p",null,[s("参考地址："),n("a",x,[s("https://zhuanlan.zhihu.com/p/672010242"),t(a)])]),n("div",M,[T,n("ul",null,[n("li",null,[s("原始内容为 "),n("a",S,[s("小小猪​"),t(a)]),s(" 创作")]),n("li",null,[s("代码部分由 "),n("a",D,[s("柒刻"),t(a)]),s(" 在原始内容上进行二次修改")])])])])}const O=o(i,[["render",P],["__file","ali_cloud_disk.html.vue"]]);export{O as default};
