import{_ as a}from"./plugin-vue_export-helper-x3n3nnut.js";import{o as e,c as s,f as n}from"./app-BaNiyK9Z.js";const i={},r=n(`<h2 id="添加普通成员" tabindex="-1"><a class="header-anchor" href="#添加普通成员" aria-hidden="true">#</a> 添加普通成员</h2><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">cat</span> ~/home/id_rsa.pub <span class="token operator">|</span> <span class="token function">ssh</span> gerrit gerrit create-account --full-name lisi <span class="token parameter variable">--email</span> lisi@example.com --ssh-key - lisi
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li><strong>cat ~/home/id_rsa.pub</strong>：把要添加的 <code>lisi</code> 用户的公钥内容读入到输入流中</li><li><strong>ssh gerrit</strong>：在 <code>~/.ssh/config</code> 中配置好的 Gerrit 服务器别名</li><li><strong>gerrit</strong>：第二个 <code>gerrit</code> 表示通过 ssh 中输入 <code>gerrit</code> 命令来进行相关操作</li><li><strong>create-account</strong>：创建新用户。<strong>注意</strong>，新建的用户名写在最后面，中间是其他参数</li><li><strong>--full-name</strong>：用户全名</li><li><strong>--email</strong>：用户的 <code>email</code> 地址</li><li><strong>--ssh-key -</strong>：最后的 <code>-</code> 表示从输入流中读取 <code>ssh</code> 的公钥内容，也就是 <code>|</code> 符号之前我们读入的 <code>lisi</code> 用户公钥内容</li><li><strong>lisi</strong>：创建 <code>lisi</code> 用户</li></ul><h2 id="添加管理员邮箱" tabindex="-1"><a class="header-anchor" href="#添加管理员邮箱" aria-hidden="true">#</a> 添加管理员邮箱</h2><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">ssh</span> gerrit gerrit set-account --add-email admin@example.com admin
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li><strong>set-account</strong>：设置账户</li><li><strong>--add-email</strong>：添加邮箱</li><li><strong>admin@example.com</strong>：邮箱地址</li><li><strong>admin</strong>：指定要设置的账户名</li></ul><h2 id="创建空项目" tabindex="-1"><a class="header-anchor" href="#创建空项目" aria-hidden="true">#</a> 创建空项目</h2><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">ssh</span> gerrit gerrit create-project test_demo
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>到已存在的项目文件中：</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token builtin class-name">cd</span> /home/gerrit/gitlab/test_demo
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>将该项目与 Gerrit 上新建的项目关联</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">git</span> push ssh://admin@192.168.4.129:29418/test_demo
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="git-clone-bare-gitlab-到-gerrit" tabindex="-1"><a class="header-anchor" href="#git-clone-bare-gitlab-到-gerrit" aria-hidden="true">#</a> git clone --bare gitlab 到 gerrit</h2><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token builtin class-name">cd</span> /home/gerrit/gerrit_size/git
<span class="token function">git</span> clone <span class="token parameter variable">--bare</span> git@192.168.4.128:gerrit_demo/test_demo.git
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="更新-githooks" tabindex="-1"><a class="header-anchor" href="#更新-githooks" aria-hidden="true">#</a> 更新 githooks</h2><p>该过程用来在 <code>commit-msg</code> 中加入 <code>change-id</code>，Gerrit 流程必备。</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token assign-left variable">gitdir</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">git</span> rev-parse --git-dir<span class="token variable">)</span></span><span class="token punctuation">;</span> <span class="token function">scp</span> <span class="token parameter variable">-p</span> <span class="token parameter variable">-P</span> <span class="token number">29418</span> lisi@192.168.4.129:hooks/commit-msg <span class="token variable">\${gitdir}</span>/hooks/
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="安装插件" tabindex="-1"><a class="header-anchor" href="#安装插件" aria-hidden="true">#</a> 安装插件</h2><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">java</span> <span class="token parameter variable">-jar</span> gerrit-3.9.1.war init <span class="token parameter variable">-d</span> gerrit_site <span class="token parameter variable">--batch</span> --install-plugin replication
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="重新加载-replication-插件" tabindex="-1"><a class="header-anchor" href="#重新加载-replication-插件" aria-hidden="true">#</a> 重新加载 replication 插件</h2><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">ssh</span> <span class="token parameter variable">-p</span> <span class="token number">29418</span> user@gerritIP gerrit plugin reload replication
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="同步仓库" tabindex="-1"><a class="header-anchor" href="#同步仓库" aria-hidden="true">#</a> 同步仓库</h2><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">sudo</span> <span class="token function">java</span> <span class="token parameter variable">-jar</span> /home/gerrit/gerritCD/bin/gerrit.war reindex <span class="token parameter variable">--index</span> projects <span class="token parameter variable">-d</span> /home/gerrit/gerritCD/
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="同步-changes" tabindex="-1"><a class="header-anchor" href="#同步-changes" aria-hidden="true">#</a> 同步 changes</h2><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">sudo</span> <span class="token function">java</span> <span class="token parameter variable">-jar</span> /home/gerrit/gerritCD/bin/gerrit.war reindex <span class="token parameter variable">--index</span> changes <span class="token parameter variable">-d</span> /home/gerrit/gerritCD/
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="同步-groups" tabindex="-1"><a class="header-anchor" href="#同步-groups" aria-hidden="true">#</a> 同步 groups</h2><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">sudo</span> <span class="token function">java</span> <span class="token parameter variable">-jar</span> /home/gerrit/gerritCD/bin/gerrit.war reindex <span class="token parameter variable">--index</span> <span class="token function">groups</span> <span class="token parameter variable">-d</span> /home/gerrit/gerritCD/
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="同步-accounts" tabindex="-1"><a class="header-anchor" href="#同步-accounts" aria-hidden="true">#</a> 同步 accounts</h2><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">sudo</span> <span class="token function">java</span> <span class="token parameter variable">-jar</span> /home/gerrit/gerritCD/bin/gerrit.war reindex <span class="token parameter variable">--index</span> accounts <span class="token parameter variable">-d</span> /home/gerrit/gerritCD/
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="根据已有的源代码上传" tabindex="-1"><a class="header-anchor" href="#根据已有的源代码上传" aria-hidden="true">#</a> 根据已有的源代码上传</h2><p>创建仓库以及分支：</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>repo forall <span class="token parameter variable">-c</span> <span class="token string">&#39;echo $REPO_PATH; ssh -p 29418 gerrit@gerritIP gerrit create-project $REPO_PATH --branch branchname --parent ALL-Project --empty-commit&#39;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>进入代码路径，添加远程库：</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>repo forall <span class="token parameter variable">-c</span> <span class="token string">&#39;echo $REPO_PATH; git remote add origin origin ssh://gerrit@gerritIP:29418/$REPO_PATH&#39;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><code>push</code> 代码：</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>repo forall <span class="token parameter variable">-c</span> <span class="token string">&#39;echo $REPO_PATH; git push ssh://gerrit@gerritIP:29418/$REPO_PATH develop:refs/heads/develop -f&#39;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div>`,36),t=[r];function d(l,c){return e(),s("div",null,t)}const h=a(i,[["render",d],["__file","command.html.vue"]]);export{h as default};
