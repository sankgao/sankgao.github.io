import{_ as a}from"./plugin-vue_export-helper-x3n3nnut.js";import{r as c,o as n,c as i,b as e,e as t,d as l,w as r,f as s}from"./app-dp7xLMdw.js";const o={},m=e("h2",{id:"描述",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#描述","aria-hidden":"true"},"#"),t(" 描述")],-1),u=e("p",null,[e("code",null,"at"),t(" 用于将命令和程序计划在指定的时间和日期在计算机上运行。仅当计划服务正在运行时，才能使用 "),e("code",null,"at"),t("。如果使用 "),e("code",null,"at"),t(" 时不带参数，则会列出已计划的命令。若要运行此命令，您必须是本地 "),e("code",null,"Administrators"),t(" 组的成员。")],-1),h={class:"hint-container tip"},g=e("p",{class:"hint-container-title"},"提示",-1),v=s(`<ul><li><p>在运行命令之前，此命令不会自动加载 <code>cmd.exe</code>。如果运行的不是可执行（<code>.exe</code>）文件，则必须在命令的开头显式加载 <code>cmd.exe</code>，如下所示：</p><div class="language-cmd line-numbers-mode" data-ext="cmd"><pre class="language-cmd"><code>cmd /c dir &gt; c:\\test.out
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li><li><p>使用 <code>at</code> 计划的命令将作为后台进程运行。输出不会显示在计算机屏幕上，要将输出重定向到文件，请使用重定向符号 <code>&gt;</code>。如果将输出重定向到文件，则无论在命令行还是在批处理文件中使用 <code>at</code>，都需要在重定向符号之前使用转义符号 <code>^</code>。例如：要将输出重定向到 <code>output.txt</code>，请键入：</p><div class="language-cmd line-numbers-mode" data-ext="cmd"><pre class="language-cmd"><code>at 14:45 c:\\test.bat ^&gt;c:\\output.txt
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li></ul><h2 id="语法" tabindex="-1"><a class="header-anchor" href="#语法" aria-hidden="true">#</a> 语法</h2><div class="language-cmd line-numbers-mode" data-ext="cmd"><pre class="language-cmd"><code>at [\\computername] [[id] [/delete] | /delete [/yes]]
at [\\computername] &lt;time&gt; [/interactive] [/every:date[,...] | /next:date[,...]] &lt;command&gt;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="选项" tabindex="-1"><a class="header-anchor" href="#选项" aria-hidden="true">#</a> 选项</h2><table><thead><tr><th style="text-align:center;">选项</th><th style="text-align:left;">描述</th></tr></thead><tbody><tr><td style="text-align:center;"><code>\\&lt;computername\\&gt;</code></td><td style="text-align:left;">指定远程计算机。如果省略此参数，则 <code>at</code> 将计划本地计算机上的命令和程序</td></tr><tr><td style="text-align:center;"><code>&lt;id&gt;</code></td><td style="text-align:left;">指定分配给已计划命令的标识号</td></tr><tr><td style="text-align:center;"><code>/delete</code></td><td style="text-align:left;">取消已计划的命令。如果省略 ID，将取消计算机上的所有已计划的命令</td></tr><tr><td style="text-align:center;"><code>/yes</code></td><td style="text-align:left;">删除计划事件时，对来自系统的所有查询回答 “是”</td></tr><tr><td style="text-align:center;"><code>&lt;time&gt;</code></td><td style="text-align:left;">指定要运行命令的时间。时间 24 小时表示法表示（即从 00：00（午夜）到 23：59），格式为 “小时:分钟”</td></tr><tr><td style="text-align:center;"><code>/interactive</code></td><td style="text-align:left;">允许命令与在命令运行时登录的用户的桌面进行交互</td></tr><tr><td style="text-align:center;"><code>/every:date[,...]</code></td><td style="text-align:left;">在每周或每月的每个指定日（例如：每个星期四或每月的第三天）运行命令</td></tr><tr><td style="text-align:center;"><code>/next:date[,...]</code></td><td style="text-align:left;">在下一个当天日期（例如：下个星期四）运行命令</td></tr><tr><td style="text-align:center;"><code>date</code></td><td style="text-align:left;">指定要运行命令的日期。您可以指定一周中的一天或多天（即，键入 M、T、W、Th、F、S、Su），也可以指定一个月中的一天或多天（即，键入 1 到 31）。用逗号分隔多个日期条目。如果省略 <code>date</code>，则 <code>at</code> 使用该月的当前日期</td></tr><tr><td style="text-align:center;"><code>&lt;command&gt;</code></td><td style="text-align:left;">指定要运行的 Windows 命令、程序（即 <code>.exe</code> 或 <code>.com</code> 文件）或批处理程序（即 <code>.bat</code> 或 <code>.cmd</code> 文件）。当命令需要路径作为参数时，请使用绝对路径（即以驱动器号开头的整个路径）。如果该命令位于远程计算机上，请为服务器和共享名称指定通用命名约定（UNC）表示法，而不是远程驱动器号</td></tr><tr><td style="text-align:center;"><code>/?</code></td><td style="text-align:left;">在命令提示符下显示帮助</td></tr></tbody></table><h2 id="示例" tabindex="-1"><a class="header-anchor" href="#示例" aria-hidden="true">#</a> 示例</h2><h3 id="显示计划信息" tabindex="-1"><a class="header-anchor" href="#显示计划信息" aria-hidden="true">#</a> 显示计划信息</h3><p>例如：显示在 Marketing 服务器上计划的命令列表。</p><div class="language-cmd line-numbers-mode" data-ext="cmd"><pre class="language-cmd"><code>at \\\\marketing
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>例如：要了解 Corp 服务器上标识号为 3 的命令的详细信息。</p><div class="language-cmd line-numbers-mode" data-ext="cmd"><pre class="language-cmd"><code>at \\\\corp 3
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="添加计划任务" tabindex="-1"><a class="header-anchor" href="#添加计划任务" aria-hidden="true">#</a> 添加计划任务</h3><p>例如：要在每五天的午夜将营销服务器的硬盘驱动器备份到磁带驱动器，请创建名为 <code>archive.cmd</code> 的批处理程序（其中包含备份命令），然后计划运行该批处理程序。</p><div class="language-cmd line-numbers-mode" data-ext="cmd"><pre class="language-cmd"><code>at \\\\marketing 00:00 /every:5,10,15,20,25,30 archive
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="取消计划任务" tabindex="-1"><a class="header-anchor" href="#取消计划任务" aria-hidden="true">#</a> 取消计划任务</h3><p>例如：要取消当前服务器上计划的所有命令。</p><div class="language-cmd line-numbers-mode" data-ext="cmd"><pre class="language-cmd"><code>at /delete
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="运行不是可执行的命令" tabindex="-1"><a class="header-anchor" href="#运行不是可执行的命令" aria-hidden="true">#</a> 运行不是可执行的命令</h3><p>要运行不是可执行（<code>.exe</code>）的命令，请在命令前加上 <code>cmd /c</code> 以加载 <code>cmd.exe</code>。</p><div class="language-cmd line-numbers-mode" data-ext="cmd"><pre class="language-cmd"><code>cmd /c dir &gt; c:\\test.out
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div>`,20);function x(p,b){const d=c("RouterLink");return n(),i("div",null,[m,u,e("div",h,[g,e("p",null,[t("AT 命令已弃用。请改用 "),l(d,{to:"/commands/cmd/schtasks.html"},{default:r(()=>[t("schtasks")]),_:1}),t("。")])]),v])}const _=a(o,[["render",x],["__file","at.html.vue"]]);export{_ as default};
