const d={"Content-Type":"application/json"},y=({serverURL:e,lang:t,paths:r,signal:o})=>(({serverURL:n,lang:i,paths:l,type:p,signal:g})=>fetch(`${n}/article?path=${encodeURIComponent(l.join(","))}&type=${encodeURIComponent(p.join(","))}&lang=${i}`,{signal:g}).then(a=>a.json()))({serverURL:e,lang:t,paths:r,type:["time"],signal:o}).then(n=>Array.isArray(n)?n:[n]),v=e=>(({serverURL:t,lang:r,path:o,type:n,action:i})=>fetch(`${t}/article?lang=${r}`,{method:"POST",headers:d,body:JSON.stringify({path:o,type:n,action:i})}).then(l=>l.json()))({...e,type:"time",action:"inc"}),c=e=>{const t=((r="")=>r.replace(/\/$/u,""))(e);return/^(https?:)?\/\//.test(t)?t:`https://${t}`},R=e=>{e.name!=="AbortError"&&console.error(e.message)},u=e=>e.dataset.path||e.getAttribute("id"),m=(e,t)=>{t.forEach((r,o)=>{r.innerText=e[o].toString()})},U=({serverURL:e,path:t=window.location.pathname,selector:r=".waline-pageview-count",update:o=!0,lang:n=navigator.language})=>{const i=new AbortController,l=Array.from(document.querySelectorAll(r)),p=a=>{const s=u(a);return s!==null&&t!==s},g=a=>y({serverURL:c(e),paths:a.map(s=>u(s)||t),lang:n,signal:i.signal}).then(s=>m(s,a)).catch(R);if(o){const a=l.filter(h=>!p(h)),s=l.filter(p);v({serverURL:c(e),path:t,lang:n}).then(h=>m(new Array(a.length).fill(h),a)),s.length&&g(s)}else g(l);return i.abort.bind(i)},A=()=>U({serverURL:{provider:"Giscus",lightTheme:"https://unpkg.com/vuepress-theme-hope@2.0.0-beta.238/templates/giscus/light.css",darkTheme:"https://unpkg.com/vuepress-theme-hope@2.0.0-beta.238/templates/giscus/dark.css",repo:"sankgao/sankgao.github.io",repoId:"R_kgDOJWT44A",category:"Announcements",categoryId:"DIC_kwDOJWT44M4CV-wc"}.serverURL});export{A as updatePageview};
